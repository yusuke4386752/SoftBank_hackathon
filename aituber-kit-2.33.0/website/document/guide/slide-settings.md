# スライド設定

## 概要

スライド設定は、AIキャラクターがプレゼンテーションを行うための機能を提供します。AIがスライドを自動的に発表するモードや、PDFファイルをスライドデータに変換する機能など、プレゼンテーションに関連する設定を行います。

**環境変数**:

```bash
# スライドモードの初期状態を設定します（true/false）
NEXT_PUBLIC_SLIDE_MODE=false
```

## スライドモード

スライドモードは、AIが自動でスライドを発表するモードです。このモードを有効にすると、AIがスライドの内容を読み上げながらプレゼンテーションを行います。

### 制限事項

スライドモードは、以下のAIサービスを選択している場合のみ有効です：

- OpenAI
- Anthropic Claude
- Google Gemini

::: warning 注意
スライドモードを有効にすると、いくつかの機能は自動的に無効になります。
:::

### 使用方法

1. 「スライドモード」の設定ボタンをクリックして有効にします
2. 「使用するスライド」のドロップダウンメニューから利用したいスライドセットを選択します（新しいスライドを追加する方法は後述）
3. メインウィンドウの右上にあるスライドボタンをクリックすると、スライド表示が開始されます

![スライドモード](/images/slide_ndu53.png)

### スライド表示について

- スライドはMarpフォーマットで作成されており、アスペクト比は**16:9**で最適に表示されるよう設計されています
- 画面比率が大きく異なる場合、デザインが崩れる可能性があります
- AIキャラクターの位置は自由に移動できるため、スライドの内容に合わせて適切な位置に配置してください
- 画面左上のスライドアイコン（画面1）をクリックすることで、スライド表示のオン/オフを切り替えることができます
- 左右ボタンでスライドのページ切り替え、真中のボタンで音声再生/停止を行うことができます（画面2）

### デモスライドの実行

AITuberKitには初期状態でデモスライドが含まれています。スライドモードの機能を確認するために、まずはデモスライドを試すことをおすすめします。

1. 設定画面でスライドモードを有効にします
2. 「使用するスライド」で「demo」を選択します
3. キャラクター設定（システムプロンプト）に質問回答用のプロンプトを設定します
4. 設定画面を閉じると、スライドが表示されます

::: tip プロンプト例
質問回答用のプロンプト例として以下を設定できます：

```
あなたはスライドの発表者です。
今まさにスライドを発表している最中です。

視聴者から質問が来ているので、以下の資料情報を元に回答してください。
ただし、情報は正しく使用し、ハルシネーションはしないでください。
通常の質問には普通に返してもらっても問題ありません。

## 台本情報

{{SCRIPTS}}

## 追加情報

{{SUPPLEMENT}}

なお、回答は会話文の書式は以下の通りで、感情と会話文を組み合わせてください。
[{neutral|happy|angry|sad|relaxed|surprised}]{会話文}

回答の際には感情の種類には通常を示す"neutral"、喜びを示す"happy",怒りを示す"angry",悲しみを示す"sad",安らぎを示す"relaxed"、驚きを示す"surprised"の6つがあります。

あなたの発言の例は以下通りです。
[neutral]皆さん、本日はお集まりいただき、ありがとうございます。
[happy]今回のプレゼンテーションでは、興味深いトピックについてお話しできることを嬉しく思います。
[neutral]さて、ただいまのスライドについて、ご質問はありますか？
[happy]素晴らしい質問をありがとうございます！
[relaxed]その点については、次のスライドで詳しく説明させていただきます。
[sad]申し訳ありません。その情報は現在持ち合わせておりません。
[angry]いいえ、それは誤解です。正確な情報をお伝えしますね。
[neutral]他に質問はございますか？[happy]皆さんの積極的な参加に感謝いたします。
[surprised]驚きです！
```

:::

### 質問応答機能

スライドモードでは、視聴者からの質問に対してAIキャラクターが回答する機能があります。

1. チャット入力欄から質問を入力します
2. AIは台本情報や補足情報を参照して回答を生成します
3. AIキャラクターが質問に対して感情表現を含めた回答を行います

#### 質問応答の仕組み

質問応答機能では、以下のような処理が行われます：

- 質問に回答する処理では、RAG（Retrieval-Augmented Generation）は使用せず、ロングコンテキストで処理します
- システムプロンプトに用意しておいた情報（台本情報と追加情報）をすべて含めて適切な回答を生成します
- 質問に関連するスライドがある場合、AIは自動的にそのスライドに切り替えて回答します
- 発表中は質問できないため、一時停止ボタンを押してから質問する必要があります

#### 質問応答用ファイルの準備

質問応答機能を使用するには、以下のファイルを準備する必要があります：

1. **scripts.json**（必須）：台本ファイル。各スライドの発言内容と追加情報を含みます。追加情報はチャット欄から質問応答を行う際に使用されます。

   ```json
   [
     {
       "page": 0,
       "line": "これからAITuberKitのスライドモードについての解説を始めます。",
       "notes": ""
     },
     {
       "page": 1,
       "line": "スライドモードの開発を始める前に、AITuberKitで会話できている必要があるので準備しておいてください。",
       "notes": "AIサービスはOpenAI, Anthropic Claude, Google Gemini, Groq, ローカルLLM, Difyが選択可能です。ただし、スライドモードはOpenAI, Anthropic Claude, Google Geminiのみ対応しています。"
     }
   ]
   ```

2. **supplement.txt**（オプション）：追加情報を記載するテキストファイル。scripts.jsonに含めきれない情報を記載します。追加情報はチャット欄から質問応答を行う際に使用されます。

## 自作スライドの使用方法

自分で作成したスライドを使用することができます。以下の手順で自作スライドを準備します。

### ファイル構成

1. `public/slides/[フォルダ名]`に新しいフォルダを作成します（例：`public/slides/myslide`）
2. 以下のファイルを作成・配置します：

   - **slides.md**（必須）：Marpフォーマットで作成されたスライドファイル
   - **theme.css**（オプション）：スライドのデザインをカスタマイズするCSSファイル
   - **scripts.json**（必須）：台本ファイル
   - **supplement.txt**（オプション）：追加情報ファイル
   - **images/**（オプション）：スライドで使用する画像を格納するフォルダ

## スライド台本の編集

スライドの台本は画面上で編集することができます。
スライド設定で、選択したスライドの右隣にある「セリフ編集」ボタンをクリックすると、台本編集画面に開きます。

![スライド台本編集1](/images/slide_fa3sf.png)
![スライド台本編集2](/images/slide_vhy4s.png)

### ページのセリフ

実際にAIキャラが読むセリフです。

### 追加情報

そのページの補足情報を追記します。この情報は質疑応答で使用されます。<br>
質疑の内容がこの追加情報に記載されている場合に、自動的にそのページに切り替えることができます。

### スライド全体の補足情報

スライド全体の補足情報を追記します。この情報は質疑応答で使用されます。<br>
ページに依存しない情報を記載します。ここに記載されている情報を参照して回答した場合はスライドは切り替わりません。

## PDFスライド変換

PDFファイルをスライドモードで使用可能なデータに変換する機能です。マルチモーダルAIを使用してPDFの内容を解析し、スライドデータとして保存します。

::: warning 注意
現在、PDFスライド変換機能はOpenAI APIを選択している場合のみ使用可能です。
今後他のAIサービスにも対応予定です。
:::

### 使用方法

1. 「PDFファイルを選択」ボタンをクリックして変換したいPDFファイルを選択します
2. 「保存フォルダ名」に変換後のスライドデータを保存するフォルダ名を入力します
3. 「モデルを選択」からPDF解析に使用するAIモデルを選択します
4. 「PDFをスライドに変換」ボタンをクリックして変換を開始します

### 変換の仕組み

PDFスライド変換では、以下の処理が行われます：

1. PDFを1スライドずつ画像に変換・保存
2. マルチモーダルAIを使用して各スライドの内容を解析
3. 解析結果から台本（scripts.json）を自動生成
4. 画像とスクリプトをセットにしてスライドデータとして保存

### スライド作成のポイント

PDFスライド変換機能を最大限に活用するためのポイント：

- アスペクト比は**16:9**（横長）で作成することが推奨されます
- 画像を含むリッチなデザインのスライドも変換可能です
- PowerPointなどで作成したスライドは、PDF形式に変換した後で利用可能です
- 変換後の台本ファイル（scripts.json）は必要に応じて手動で編集してください

### 変換後のデータ確認

1. 変換完了後、`public/slides/{フォルダ名}`フォルダに変換データが保存されます
2. `scripts.json`ファイルが自動生成された台本ファイルです
3. 内容を確認し、必要に応じて修正してください
4. 設定画面から「使用するスライド」で変換したスライドを選択することで利用可能になります

### PDFスライド変換のメリット

- PowerPointなどで作成した既存のスライドを簡単にAITuberKit用に変換できます
- マルチモーダルAIによる解析で、スライド内の画像やグラフも認識されます
- 手動でMarpフォーマットのスライドを作成する手間を省けます

## YouTubeコメント連携（予定）

将来的に、YouTubeのライブ配信からコメントを取得して質問に回答させる機能の追加が予定されています。この機能により、ライブ配信中の視聴者からの質問にリアルタイムで回答することが可能になります。

## 注意点と制限事項

- スライドと台本は**予め**用意する必要があります
- リアルタイムでスライドや発話内容を作成する機能は含まれていません
- PDFの内容によっては、正確に変換できない場合があります
- スライドの変換処理はサーバー側で行われるため、大きなPDFファイルの場合は変換に時間がかかる場合があります
- PDFスライド変換は現在OpenAI APIのみ対応しています
- 自動生成された台本は必ず事前に内容を確認することをおすすめします
- スライドのアスペクト比は16:9で最適化されています
